# オーケストレートコマンド

複雑なタスク用の順序付きエージェントワークフロー。

## 使用法

`/orchestrate [workflow-type] [task-description]`

## ワークフロータイプ

### feature
完全な機能実装ワークフロー:
```
planner -> tdd-guide -> code-reviewer -> security-reviewer
```

### bugfix
バグ調査と修正ワークフロー:
```
explorer -> tdd-guide -> code-reviewer
```

### refactor
安全なリファクタリングワークフロー:
```
architect -> code-reviewer -> tdd-guide
```

### security
セキュリティ中心のレビュー:
```
security-reviewer -> code-reviewer -> architect
```

## 実行パターン

ワークフロー内の各エージェントについて:

1. **エージェントを呼び出す** 前のエージェントからのコンテキスト付きで
2. **出力を収集** 構造化されたハンドオフドキュメントとして
3. **次のエージェントに渡す** チェーン内で
4. **結果を集約** 最終レポートに

## ハンドオフドキュメント形式

エージェント間でハンドオフドキュメントを作成:

```markdown
## ハンドオフ: [前のエージェント] -> [次のエージェント]

### コンテキスト
[何が行われたかの概要]

### 発見事項
[主要な発見または決定事項]

### 変更されたファイル
[触れたファイルのリスト]

### 未解決の質問
[次のエージェント向けの未解決項目]

### 推奨事項
[提案された次のステップ]
```

## 例: 機能ワークフロー

```
/orchestrate feature "ユーザー認証を追加"
```

実行:

1. **プランナーエージェント**
   - 要件を分析
   - 実装計画を作成
   - 依存性を特定
   - 出力: `ハンドオフ: planner -> tdd-guide`

2. **TDD ガイドエージェント**
   - プランナーハンドオフを読む
   - テストを最初に書く
   - テストに合わせて実装
   - 出力: `ハンドオフ: tdd-guide -> code-reviewer`

3. **コードレビューエージェント**
   - 実装をレビュー
   - 問題をチェック
   - 改善を提案
   - 出力: `ハンドオフ: code-reviewer -> security-reviewer`

4. **セキュリティレビューエージェント**
   - セキュリティ監査
   - 脆弱性チェック
   - 最終的な承認
   - 出力: 最終レポート

## 最終レポート形式

```
オーケストレーションレポート
====================
ワークフロー: feature
タスク: ユーザー認証を追加
エージェント: planner -> tdd-guide -> code-reviewer -> security-reviewer

サマリー
-------
[1 段落のサマリー]

エージェント出力
-------------
Planner: [サマリー]
TDD ガイド: [サマリー]
コードレビュー: [サマリー]
セキュリティレビュー: [サマリー]

ファイル変更
-------------
[変更されたすべてのファイルをリスト]

テスト結果
------------
[テスト成功/失敗サマリー]

セキュリティステータス
---------------
[セキュリティ発見事項]

推奨事項
--------------
[リリース / 作業が必要 / ブロック済み]
```

## 並列実行

独立したチェックの場合、エージェントを並列で実行:

```markdown
### 並列フェーズ
同時に実行:
- code-reviewer (品質)
- security-reviewer (セキュリティ)
- architect (設計)

### 結果をマージ
出力を単一のレポートに結合
```

## 引数

$ARGUMENTS:
- `feature <description>` - 完全な機能ワークフロー
- `bugfix <description>` - バグ修正ワークフロー
- `refactor <description>` - リファクタリングワークフロー
- `security <description>` - セキュリティレビューワークフロー
- `custom <agents> <description>` - カスタムエージェントシーケンス

## カスタムワークフロー例

```
/orchestrate custom "architect,tdd-guide,code-reviewer" "キャッシングレイヤーを再設計"
```

## ヒント

1. **複雑な機能の場合はプランナーで開始**
2. **マージ前には常にコードレビューを含める**
3. **認証/支払い/個人情報にはセキュリティレビューを使用**
4. **ハンドオフは簡潔に** - 次のエージェントが必要なことに焦点を当てる
5. **必要に応じてエージェント間で検証を実行**
